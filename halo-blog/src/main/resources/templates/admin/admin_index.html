<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{admin/module/head :: head(~{::title}, _, _)}">
    <title th:text="${option['blog_title']}?:'' + ' | ' + #{admin.index.title}"></title>
</head>
<body class="hold-transition sidebar-mini"
      th:classappend="${option['admin_theme']?:'skin-blue'} + ' ' + ${option['admin_layout']?:''} + ' ' +
    ${option['sidebar_style']?:''}">
    <div th:replace="~{admin/module/header :: header}"></div>
    <div th:replace="~{admin/module/sidebar :: sidebar}"></div>

    <div class="content-wrapper">
        <section class="content-header" id="animated-header">
            <h1 style="display: inline-block;">[[#{admin.index.title}]]</h1>
            <a class="btn-header" id="btnWidgetsOption" href="javascript:void(0)">
                [[#{admin.index.btn.widgets}]]
            </a>
            <ol class="breadcrumb">
                <li>
                    <a th:href="@{/admin}"><i class="fa fa-dashboard"></i> [[#{admin.index.bread.index}]]</a>
                </li>
                <li class="active">[[#{admin.index.bread.active}]]</li>
            </ol>
        </section>
        <section class="content container-fluid" id="animated-content">
            <div class="row">
                <div class="col-lg-12 col-xs-12" id="widgetOptionsPanel" style="display: none">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <h3 class="box-title">[[#{admin.index.widgets.title}]]</h3>
                        </div>
                        <form class="form-horizontal" id="widgetsOption">
                            <div class="box-body">
                                <div class="col-sm-6 col-xs-6">
                                    <div class="form-group">
                                        <label for="widgetPostCount" class="col-sm-4 control-label">[[#{admin.index.widgets.post-count}]]：</label>
                                        <div class="col-sm-8 control-radio">
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_postcount" th:id="widgetPostCount"
                                                       th:value="true"
                                                       th:checked="${option['widget_postcount']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.display}]]</label>
                                                </div>
                                            </div>
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_postcount" id="widgetPostCount"
                                                       value="false" th:checked="${option['widget_postcount']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.hide}]]</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="widgetCommentCount" class="col-sm-4 control-label">[[#{admin.index.widgets.comment-count}]]：</label>
                                        <div class="col-sm-8 control-radio">
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_commentcount"
                                                       id="widgetCommentCount" value="true"
                                                       th:checked="${option['widget_commentcount']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.display}]]</label>
                                                </div>
                                            </div>
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_commentcount"
                                                       th:id="widgetCommentCount" value="false"
                                                       th:checked="${option['widget_commentcount']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.hide}]]</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="widgetAttachmentCount" class="col-sm-4 control-label">[[#{admin.index.widgets.attachment-count}]]：</label>
                                        <div class="col-sm-8 control-radio">
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_attachmentcount"
                                                       th:id="widgetAttachmentCount" value="true"
                                                       th:checked="${option['widget_attachmentcount']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.display}]]</label>
                                                </div>
                                            </div>
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_attachmentcount"
                                                       id="widgetAttachmentCount" value="false"
                                                       th:checked="${option['widget_attachmentcount']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.hide}]]</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="widgetDayCount" class="col-sm-4 control-label">[[#{admin.index.widgets.day-count}]]：</label>
                                        <div class="col-sm-8 control-radio">
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_daycount" th:id="widgetDayCount"
                                                       value="true" th:checked="${option['widget_daycount']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.display}]]</label>
                                                </div>
                                            </div>
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_daycount" id="widgetDayCount"
                                                       value="false" th:checked="${option['widget_daycount']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.hide}]]</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-xs-6">
                                    <div class="form-group">
                                        <label for="widgetPostLastest" class="col-sm-4 control-label">[[#{admin.index.widgets.post-lastest}]]：</label>
                                        <div class="col-sm-8 control-radio">
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_postlastest"
                                                       th:id="widgetPostLastest" value="true"
                                                       th:checked="${option['widget_postlastest']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.display}]]</label>
                                                </div>
                                            </div>
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_postlastest" id="widgetPostLastest"
                                                       value="false"
                                                       th:checked="${option['widget_postlastest']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.hide}]]</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="widgetCommentLastest" class="col-sm-4 control-label">[[#{admin.index.widgets.comment-lastest}]]：</label>
                                        <div class="col-sm-8 control-radio">
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_commentlastest"
                                                       th:id="widgetCommentLastest" value="true"
                                                       th:checked="${option['widget_commentlastest']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.display}]]</label>
                                                </div>
                                            </div>
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_commentlastest"
                                                       id="widgetCommentLastest" value="false"
                                                       th:checked="${option['widget_commentlastest']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.hide}]]</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="widgetLogsLastest" class="col-sm-4 control-label">[[#{admin.index.widgets.logs-lastest}]]：</label>
                                        <div class="col-sm-8 control-radio">
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_logslastest"
                                                       th:id="widgetLogsLastest" value="true"
                                                       th:checked="${option['widget_logslastest']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.display}]]</label>
                                                </div>
                                            </div>
                                            <div class="pretty p-default p-round">
                                                <input type="radio" name="widget_logslastest" id="widgetLogsLastest"
                                                       value="false"
                                                       th:checked="${option['widget_logslastest']}?:true">
                                                <div class="state p-primary">
                                                    <label>[[#{common.radio.hide}]]</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="box-footer">
                                <button type="button" class="btn btn-primary pull-right"
                                        onclick="saveOptions('widgetsOption')">[[#{common.btn.save}]]
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                <th:block th:if="${option['widget_postcount']}?:true">
                    <div class="col-lg-3 col-xs-6" id="widgetPostCountBody">
                        <div class="small-box bg-aqua">
                            <div class="inner">
                                <h3>
                                    [[${postsCount}]]
                                </h3>
                                <p>[[#{admin.index.widgets.posts}]]</p>
                            </div>
                            <div class="icon"><i class="ion ion-bag"></i></div>
                            <a data-pjax="true" th:href="@{/admin/posts}" class="small-box-footer">[[#{common.btn.view-all}]]
                                <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                </th:block>
                <th:block th:if="${option['widget_commentcount']}?:true">
                    <div class="col-lg-3 col-xs-6" id="widgetCommentCountBody">
                        <div class="small-box bg-green">
                            <div class="inner"><h3>[[${commentCount}]]</h3>
                                <p>[[#{admin.index.widgets.comments}]]</p></div>
                            <div class="icon"><i class="ion ion-stats-bars"></i></div>
                            <a data-pjax="true" th:href="@{/admin/comments}" class="small-box-footer">[[#{common.btn.view-all}]]
                                <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                </th:block>
                <th:block th:if="${option['widget_attachmentcount']}?:true">
                    <div class="col-lg-3 col-xs-6" id="widgetAttachmentCountBody">
                        <div class="small-box bg-yellow">
                            <div class="inner"><h3>[[${mediaCount}]]</h3>
                                <p>[[#{admin.index.widgets.attachments}]]</p></div>
                            <div class="icon"><i class="ion ion-person-add"></i></div>
                            <a data-pjax="true" th:href="@{/admin/attachments}" class="small-box-footer">[[#{common.btn.upload-image}]]
                                <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                </th:block>
                <th:block th:if="${option['widget_daycount']}?:true">
                    <div class="col-lg-3 col-xs-6" id="widgetDayCountBody">
                        <div class="small-box bg-red">
                            <div class="inner"><h3 id="blogStart">[[${hadDays}]]</h3>
                                <p>[[#{admin.index.widgets.day-count}]]</p></div>
                            <div class="icon"><i class="ion ion-pie-graph"></i></div>
                            <a href="javascript:void(0)" class="small-box-footer" data-toggle="modal"
                               data-target="#blogInfo">[[${option['blog_start']}]]<i class="fa fa-star"></i></a>
                        </div>
                    </div>
                </th:block>
            </div>

            <div class="row">
                <th:block th:if="${option['widget_postlastest']}?:true">
                    <div class="col-lg-6 col-xs-12" id="widgetPostLastestBody">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">[[#{admin.index.widgets.post-lastest}]]</h3>
                                <div class="box-tools">
                                    <button type="button" class="btn btn-box-tool" data-widget="collapse"
                                            data-toggle="tooltip" title="Collapse">
                                        <i class="fa fa-minus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="box-body table-responsive no-padding">
                                <table class="table table-hover text-center">
                                    <tbody>
                                    <tr>
                                        <th width="50%">[[#{common.th.title}]]</th>
                                        <th>[[#{common.th.status}]]</th>
                                        <th>[[#{common.th.date}]]</th>
                                    </tr>
                                    <tr th:each="post : ${postTopFive}">
                                        <td th:if="${post.postStatus == 0}">
                                            <a target="_blank" th:href="@{/archives/{url}(url=${post.postUrl})}">[[${post.postTitle}]]</a>
                                        </td>
                                        <td th:unless="${post.postStatus == 0}">[[${post.postTitle}]]</td>
                                        <td class="text-center">
                                            <span th:if="${post.postStatus == 0}" class="label bg-green">[[#{common.status.published}]]</span>
                                            <span th:if="${post.postStatus == 1}" class="label bg-yellow">[[#{common.status.draft}]]</span>
                                            <span th:if="${post.postStatus ne 0 and post.postStatus ne 1}"
                                                  class="label bg-red">[[#{common.status.recycle-bin}]]</span>
                                        </td>
                                        <td class="date-moment" th:attr="data-date=${post.postDate}">[[${post.postDate}]]</td>
                                    </tr>
                                    <tr th:if="${#lists.isEmpty(postTopFive)}">
                                        <td>[[#{common.text.no-data}]]</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </th:block>
                <th:block th:if="${option['widget_commentlastest']}?:true">
                    <div class="col-lg-6 col-xs-12" id="widgetCommentLastestBody">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">[[#{admin.index.widgets.comment-lastest}]]</h3>
                                <div class="box-tools">
                                    <button type="button" class="btn btn-box-tool" data-widget="collapse"
                                            data-toggle="tooltip" title="Collapse">
                                        <i class="fa fa-minus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="box-body table-responsive no-padding">
                                <table class="table table-hover text-center">
                                    <tbody>
                                    <tr>
                                        <th>[[#{common.th.comment-author}]]</th>
                                        <th width="20%">[[#{common.th.comment-page}]]</th>
                                        <th width="30%">[[#{common.th.content}]]</th>
                                        <th>[[#{common.th.status}]]</th>
                                        <th>[[#{common.th.date}]]</th>
                                    </tr>
                                    <th:block th:each="comment : ${comments}">
                                        <tr>
                                            <td>[[${comment.commentAuthor}]]</td>
                                            <td>
                                                <a target="_blank" th:if="${comment.post.postType eq 'post'}"
                                                   th:href="@{/archives/{url}(url=${comment.post.postUrl})}">[[${comment.post.postTitle}]]</a>
                                                <a target="_blank" th:if="${comment.post.postType ne 'post'}"
                                                   th:href="@{/p/{url}(url=${comment.post.postUrl})}">[[${comment.post.postTitle}]]</a>
                                            </td>
                                            <td>
                                                <!--<#switch comment.commentStatus>-->
                                                <!--<#case 0>-->
                                                <!--${comment.commentContent}-->
                                                <!--<#break>-->
                                                <!--<#case 1>-->
                                                <!--${comment.commentContent}-->
                                                <!--<#break>-->
                                                <!--<#case 2>-->
                                                <!--${comment.commentContent}-->
                                                <!--<#break>-->
                                                <!--</#switch>-->
                                                [[${#strings.substring(comment.commentContent, 0, 15)}]].....
                                                <!--<th:block th:switch="${comment.commentStatus}">-->
                                                <!--<th:block th:case="0" th:text="${comment.commentContent}"/>-->
                                                <!--<th:block th:case="1"-->
                                                <!--<th:block th:case="2"-->
                                                <!--</th:block>-->
                                            </td>
                                            <td>
                                                <th:block th:switch="${comment.commentStatus}">
                                                    <span th:case="0" class="label bg-green">[[#{common.status.published}]]</span>
                                                    <span th:case="1" class="label bg-yellow">[[#{common.status.checking}]]</span>
                                                    <span th:case="2" class="label bg-red">[[#{common.status.recycle-bin}]]</span>
                                                </th:block>
                                            </td>
                                            <td class="date-moment" th:attr="data-date=${comment.commentDate}">[[${comment.commentDate}]]</td>
                                        </tr>
                                    </th:block>
                                    <tr th:if="${#lists.isEmpty(comments)}">
                                        <td>[[#{common.text.no-data}]]</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </th:block>
                <th:block th:if="${option['widget_logslastest']}?:true">
                    <div class="col-lg-6 col-xs-12" id="widgetLogsLastestBody">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">[[#{admin.index.widgets.logs-lastest}]]</h3>
                                <div class="box-tools">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-box-tool dropdown-toggle"
                                                data-toggle="dropdown" aria-expanded="false">
                                            <i class="fa fa-bars"></i></button>
                                        <ul class="dropdown-menu pull-right" role="menu">
                                            <li><a href="javascript:void(0)"
                                                   th:attr="data-url=@{/admin/logs}, data-msg=#{admin.index.widgets.text.all-logs}"
                                                   onclick="halo.layerModal()">[[#{common.btn.view-all}]]</a></li>
                                            <li><a th:href="@{/admin/logs/clear}">[[#{admin.index.widgets.btn.clear-logs}]]</a>
                                            </li>
                                        </ul>
                                        <button type="button" class="btn btn-box-tool" data-widget="collapse"
                                                data-toggle="tooltip" title="Collapse">
                                            <i class="fa fa-minus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="box-body table-responsive no-padding">
                                <table class="table table-hover text-center">
                                    <tbody>
                                    <tr>
                                        <th>[[#{common.th.action}]]</th>
                                        <th>[[#{common.th.result}]]</th>
                                        <th>IP</th>
                                        <th>[[#{common.th.date}]]</th>
                                    </tr>
                                    <tr th:each="log : ${logs}">
                                        <td>[[${log.logTitle}]]</td>
                                        <td>[[${log.logContent}]]</td>
                                        <td>[[${log.logIp}]]</td>
                                        <td>[[${#dates.format(log.logCreated, 'yyyy-MM-dd HH:mm')}]]</td>
                                    </tr>
                                    <tr th:if="${#lists.isEmpty(logs)}">
                                        <td>[[#{common.text.no-data}]]</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </th:block>
            </div>
        </section>
        <div class="modal fade" id="blogInfo" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="blog-data">[[#{admin.index.blog-data.title}]]</h4>
                    </div>
                    <div class="modal-body">
                        <p>「[[${option['blog_title']}]]」[[#{admin.index.blog-data.days-count-before}]]<span
                            id="blogStartDay">[[${hadDays}]]</span>[[#{admin.index.blog-data.days-count-after}]]</p>
                        <p>[[#{admin.index.blog-data.during}]]</p>
                        <p>[[#{admin.index.blog-data.posts-count-before}]]&nbsp;
                            [[${postsCount}?:0]]
                            &nbsp;[[#{admin.index.blog-data.posts-count-after}]]</p>
                        <p>[[#{admin.index.blog-data.tags-count-before}]]&nbsp;
                            [[${tagSize}?:0]]
                            &nbsp;[[#{admin.index.blog-data.tags-count-after}]]</p>
                        <p>[[#{admin.index.blog-data.comments-count-before}]]&nbsp;
                            [[${commentCount}?:0]]&nbsp;[[#{admin.index.blog-data.comments-count-after}]]</p>
                        <p>[[#{admin.index.blog-data.links-count-before}]]&nbsp;
                            [[${linkSize}?:0]]
                            &nbsp;[[#{admin.index.blog-data.links-count-after}]]</p>
                        <p>[[#{admin.index.blog-data.views-count-before}]]&nbsp;
                            [[${postViewsSum}?:0]]&nbsp;[[#{admin.index.blog-data.views-count-after}]]</p>
                        <p>[[#{admin.index.blog-data.motto}]]</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal">
                            [[#{common.btn.define}]]
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <th:block th:inline="javascript" th:replace="~{admin/module/footer :: scriptEntry(~{::script})}">
        <script type="application/javascript" th:src="@{/halo-backend/js/moment.js}"></script>
        <script type="application/javascript" th:inline="javascript">
            $('#btnWidgetsOption').click(function () {
                $('#widgetOptionsPanel').slideToggle(400);
            });

            $('.date-moment').each(function() {
                let dateFromNow = moment($(this).data('date')).fromNow();
                $(this).text(dateFromNow);
            });
        </script>
    </th:block>
</body>
</html>